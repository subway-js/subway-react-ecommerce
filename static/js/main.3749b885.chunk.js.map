{"version":3,"sources":["subwayUtils/subwayRef.js","subwayUtils/customSubwayHooks.js","aggregates/navigation/verbs/events.js","aggregates/navigation/verbs/public.js","aggregates/navigation/verbs/commands.js","aggregates/navigation/handlers/commands.js","aggregates/navigation/handlers/events.js","aggregates/navigation/commandCreators.js","aggregates/navigation/ui/containers/navbar.js","aggregates/navigation/ui/containers/breadcrumbs.js","aggregates/navigation/index.js","aggregates/products/verbs/commands.js","aggregates/products/commandCreators.js","aggregates/products/verbs/events.js","aggregates/products/api/data.js","aggregates/products/handlers/commands.js","aggregates/products/api/mockApi.js","aggregates/products/handlers/events.js","aggregates/products/ui/components/addToCartButton.js","aggregates/products/ui/containers/productList.js","aggregates/products/ui/containers/productDetails.js","aggregates/products/ui/components/disclaimer.js","aggregates/products/index.js","aggregates/shoppingCart/verbs/events.js","aggregates/shoppingCart/verbs/public.js","aggregates/shoppingCart/verbs/commands.js","aggregates/shoppingCart/handlers/commands.js","aggregates/shoppingCart/api/mockApi.js","aggregates/shoppingCart/handlers/events.js","aggregates/shoppingCart/ui/containers/headerShoppingCartDropdown.js","aggregates/shoppingCart/commandCreators.js","aggregates/shoppingCart/ui/containers/checkout.js","aggregates/shoppingCart/index.js","aggregates/session/verbs/events.js","aggregates/session/verbs/commands.js","aggregates/session/verbs/public.js","aggregates/session/api/mockApi.js","aggregates/session/handlers/commands.js","aggregates/session/handlers/events.js","aggregates/session/commandCreators.js","aggregates/session/ui/containers/loginModal.js","aggregates/session/index.js","App.js","subwayUtils/utils.js","serviceWorker.js","index.js"],"names":["Subway","window","useObserveAggregateState","aggregateName","selector","d","useState","data","setData","useEffect","console","log","stopObserving","selectAggregate","observeState","nextState","useReactToEvent","consumerAggregateName","eventName","fn","unsubscribe","publicChannel","reactToEvent","type","payload","Events","PublicCommands","Commands","cmdHandlers","command","handler","triggerEvents","id","evtHandlers","state","updateState","selectedProductName","currentPage","product","title","selectHomePage","AGGREGATE_NAME","Navbar","shoppingCartMenuItem","NAVIGATION_AGGREGATE_NAME","userLogged","username","aggregateState","Menu","size","borderless","fixed","Container","Item","Header","color","position","Button","onClick","style","marginLeft","basic","Popup","on","trigger","icon","Icon","name","Content","padding","List","Divider","selection","verticalAlign","Breadcrumbs","Grid","relaxed","columns","Column","Breadcrumb","Section","active","link","textAlign","content","labelPosition","aggregateConfig","initialState","bootstrap","reactToCommand","triggerAddToShoppingCart","PRODUCTS_LIST_LOADED","img","price","newPrice","ccy","rating","reviewsCount","a","async","Promise","resolve","reject","setTimeout","reverse","productsList","PRODUCT_SELECTED_FOR_DETAILS","selectedProduct","AddToCartButton","loading","setLoading","fluid","ProductList","detailsButtonHoveredId","setDetailsButtonHoveredId","PRODUCTS_AGGREGATE_NAME","productList","map","key","Card","Image","label","as","corner","Dimmer","Dimmable","backgroundColor","onMouseOver","onMouseLeave","dimmed","src","wrapped","productAggregate","selectProductForDetails","Meta","Rating","disabled","defaultRating","maxRating","Description","Label","tag","extra","ProductDetails","Segment","Group","horizontal","padded","compact","i","messages","Disclaimer","visible","setVisible","Transition","animation","duration","Message","onDismiss","zIndex","bottom","right","width","header","list","SUBMIT_ORDER","items","status","orderSubmissionResult","events","concat","successful","has","prod","get","set","count","checkoutSuccessful","Map","HeaderShoppingCartDropdown","SHOPPING_CART_AGGREGATE_NAME","cartItems","Array","from","item","itemsTotal","reduce","acc","curr","length","Subheader","divided","circular","className","toFixed","Checkout","checkoutCompleted","setCheckoutCompleted","shoppingMap","orderSuccessful","totalCurrency","total","marginTop","Table","Row","HeaderCell","Body","Cell","ribbon","textDecoration","positive","Footer","attached","floated","animated","hidden","warning","FAKE_ACCOUNT","authenticate","password","jwt","message","rejectCommand","MockAPI","authenticationResult","loginModalVisible","show","broadcastEvent","userLoggedIn","hideLoginScreen","simulateLogin","onRejected","LoginModal","authInProgress","setAuthInProgress","wrongCredentials","setWrongCredentials","isLoginModalVisible","Modal","open","dimmer","onClose","Form","Field","Input","value","Actions","reasonString","meta","App","aggregates","background","Boolean","location","hostname","match","sessionAggregateConfig","productAggregateConfig","navigationAggregateConfig","shoppingCartAggregateConfig","forEach","aggregate","onError","initHandlers","createAggregate","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.3749b885.chunk.js","sourcesContent":["export const Subway = window.Subway;\n","import { useState, useEffect } from \"react\";\nimport { Subway } from \"./subwayRef\";\n\nexport const useObserveAggregateState = (aggregateName, selector = d => d) => {\n  const [data, setData] = useState(null);\n\n  useEffect(() => {\n    console.log(\">>>> useObserveAggregateState init\");\n    const productsAggregate = Subway.selectAggregate(aggregateName);\n    const stopObserving = productsAggregate.observeState(nextState => {\n      setData(selector(nextState));\n    });\n    return () => {\n      stopObserving();\n    };\n  }, []);\n\n  return [data];\n};\n\n\nexport const useReactToEvent = (consumerAggregateName, eventName, fn = null) => {\n  const [data, setData] = useState(null);\n  useEffect(() => {\n    console.log(\">>>> useReactToEvent init !!! TODO: what if return null? and triggered action?\");\n    const consumer = Subway.selectAggregate(consumerAggregateName);\n    const unsubscribe = consumer.publicChannel().reactToEvent(eventName, (type, payload) => {\n      setData(fn ? fn(payload): payload);\n    });\n    return () => {\n      unsubscribe();\n    };\n  });\n  return [data];\n};\n\n/*\nexport const useSpyAggregateEvent = (aggregateName, eventID, selector) => {\n  const [data, setData] = useState(null);\n\n  useEffect(() => {\n    const unsubscribe = Subway.selectAggregate(aggregateName).spy(eventID, {\n      next: eventPayload => {\n        setData(selector(eventPayload));\n      }\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, [aggregateName, eventID, selector]);\n\n  return [data];\n};\n*/\n","export const Events = {\n  PRODUCT_PAGE_SELECTED: \"PRODUCT_PAGE_SELECTED\",\n  HOME_PAGE_SELECTED: \"HOME_PAGE_SELECTED\",\n  CHECKOUT_PAGE_REQUEST_SUBMITTED: \"CHECKOUT_PAGE_REQUEST_SUBMITTED\"\n};\n","export const PublicCommands = {\n  NAVIGATE_TO_PRODUCT_DETAILS: \"NAVIGATE_TO_PRODUCT_DETAILS\",\n  NAVIGATE_TO_CHECKOUT_PAGE: \"NAVIGATE_TO_CHECKOUT_PAGE\"\n};\n","export const Commands = {\n  SELECT_HOME_PAGE: \"SELECT_HOME_PAGE\"\n};\n","import { Commands } from \"../verbs/commands\";\nimport { Events } from \"../verbs/events\";\n\nexport const cmdSelectHomePageHandler = {\n  command: Commands.SELECT_HOME_PAGE,\n  handler: ({}, { triggerEvents }) =>\n    triggerEvents([{ id: Events.HOME_PAGE_SELECTED }])\n};\n\n\nexport const cmdHandlers = [\n  cmdSelectHomePageHandler,\n];\n","import { Events } from \"../verbs/events\";\n\nexport const evtHomePageSelectedHandler = {\n  command: Events.HOME_PAGE_SELECTED,\n  handler: ({ state }, { updateState }) => {\n    updateState({\n      ...state,\n      selectedProductName: null,\n      currentPage: \"home\"\n    })\n  }\n};\n\nexport const evtProductPageSelectedHandler = {\n  command: Events.PRODUCT_PAGE_SELECTED,\n  handler: ({ state, payload }, { updateState }) => {\n    updateState({\n      ...state,\n      selectedProductName: payload.product.title,\n      currentPage: \"product\"\n    })\n  }\n};\n\nexport const evtCheckoutPageRequestSubmittedHandler = {\n  command: Events.CHECKOUT_PAGE_REQUEST_SUBMITTED,\n  handler: ({ state }, { updateState }) => {\n    updateState({\n      ...state,\n      selectedProductName: null,\n      currentPage: \"checkout\"\n    })\n  }\n};\n\nexport const evtHandlers = [\n  evtHomePageSelectedHandler,\n  evtProductPageSelectedHandler,\n  evtCheckoutPageRequestSubmittedHandler\n];\n","import { AGGREGATE_NAME } from \"./index\";\nimport { Commands } from \"./verbs/commands\";\nimport { Subway } from \"../../subwayUtils/\";\n\nexport const selectHomePage = () => {\n  Subway.selectAggregate(AGGREGATE_NAME).command(Commands.SELECT_HOME_PAGE);\n};\n\nexport const showLoginScreen = () => {\n  Subway.selectAggregate(AGGREGATE_NAME).publicChannel().command(\"SHOW_LOGIN_MODAL\");\n};\n\nexport const logout = () => {\n  Subway.selectAggregate(AGGREGATE_NAME).publicChannel().command(\n    \"PERFORM_USER_LOGOUT\"\n  );\n};\n","import React from \"react\";\nimport {\n  Container,\n  Menu,\n  Header,\n  Button,\n  Popup,\n  List,\n  Icon,\n  Divider\n} from \"semantic-ui-react\";\nimport { useObserveAggregateState, useReactToEvent } from \"../../../../subwayUtils\";\nimport { showLoginScreen, logout } from \"../../commandCreators\";\n\nimport { AGGREGATE_NAME as NAVIGATION_AGGREGATE_NAME } from \"../../\";\n\nexport function Navbar({ shoppingCartMenuItem }) {\n\n  const [userLoggedInPayload] =\n    useReactToEvent(\n      NAVIGATION_AGGREGATE_NAME,\n      \"SESSION_STATUS_UPDATED\",\n      payload => payload\n      );\n\n  const { userLogged, username } = userLoggedInPayload || {};\n\n  const [currentPage] = useObserveAggregateState(\n    NAVIGATION_AGGREGATE_NAME,\n    aggregateState => aggregateState.currentPage\n  );\n\n  return (\n    <Menu size=\"small\" borderless fixed=\"top\">\n      <Container>\n        <Menu.Item>\n          <Header color=\"teal\">SubwayJS eComm</Header>\n        </Menu.Item>\n\n        {currentPage !== \"checkout\" && (\n          <Menu.Item position=\"right\">\n            {shoppingCartMenuItem}\n            {!userLogged && (\n              <Button\n                onClick={() => showLoginScreen()}\n                style={{ marginLeft: 10 }}\n                color=\"teal\"\n                basic\n              >\n                {\" \"}\n                Log-in\n              </Button>\n            )}\n            {userLogged && (\n              <Popup\n                on=\"click\"\n                position=\"bottom right\"\n                trigger={\n                  <Button basic color=\"teal\" icon style={{ marginLeft: 10 }}>\n                    <Icon name=\"user\" />\n                  </Button>\n                }\n              >\n                <Popup.Content style={{ padding: \"0 !important\" }}>\n                  <List.Header>{`Hi, ${username}`} </List.Header>\n                  <Divider />\n                  <List selection verticalAlign=\"middle\">\n                    <List.Item onClick={() => logout()}>Logout</List.Item>\n                  </List>\n                </Popup.Content>\n              </Popup>\n            )}\n          </Menu.Item>\n        )}\n      </Container>\n    </Menu>\n  );\n}\n","import React from \"react\";\nimport { Breadcrumb, Button, Grid } from \"semantic-ui-react\";\n\nimport {\n  useSpyAggregateEvent,\n  useObserveAggregateState\n} from \"../../../../subwayUtils/\";\nimport { selectHomePage } from \"../../commandCreators\";\n\nimport { AGGREGATE_NAME as NAVIGATION_AGGREGATE_NAME } from \"../../\";\n\nexport function Breadcrumbs() {\n\n  const [navigationState] = useObserveAggregateState(NAVIGATION_AGGREGATE_NAME);\n  const { currentPage, selectedProductName} = navigationState || {};\n\n  return (\n    <Grid relaxed columns={2}>\n      <Grid.Column>\n        <Breadcrumb>\n          {currentPage === \"home\" && (\n            <Breadcrumb.Section active>Products</Breadcrumb.Section>\n          )}\n          {currentPage === \"product\" && selectedProductName && (\n            <>\n              <Breadcrumb.Section active link onClick={() => selectHomePage()}>\n                Products\n              </Breadcrumb.Section>\n              <Breadcrumb.Divider />\n              <Breadcrumb.Section active>\n                {selectedProductName}\n              </Breadcrumb.Section>\n            </>\n          )}\n          {currentPage === \"checkout\" && (\n            <>\n              <Breadcrumb.Section active link onClick={() => selectHomePage()}>\n                Products\n              </Breadcrumb.Section>\n              <Breadcrumb.Divider />\n              <Breadcrumb.Section active>Checkout</Breadcrumb.Section>\n            </>\n          )}\n        </Breadcrumb>\n      </Grid.Column>\n      {(currentPage === \"product\" || currentPage === \"checkout\") && (\n        <Grid.Column textAlign=\"right\">\n          <Button\n            onClick={() => selectHomePage()}\n            size=\"tiny\"\n            content=\"Back to products\"\n            icon=\"angle left\"\n            color=\"teal\"\n            labelPosition=\"left\"\n          />\n        </Grid.Column>\n      )}\n    </Grid>\n  );\n}\n","import { Subway } from \"../../subwayUtils/\";\n\nimport { Events } from \"./verbs/events\";\nimport { PublicCommands } from \"./verbs/public\";\n\nimport { cmdHandlers } from \"./handlers/commands\";\nimport { evtHandlers } from \"./handlers/events\";\n\nexport { Navbar } from \"./ui/containers/navbar\";\nexport { Breadcrumbs } from \"./ui/containers/breadcrumbs\";\n\nexport const AGGREGATE_NAME = \"NavigationAggregate\";\n\nconst initialState = {\n  currentPage: \"home\"\n};\n\nexport const aggregateConfig = {\n  name: AGGREGATE_NAME,\n  initialState,\n  cmdHandlers,\n  evtHandlers,\n  bootstrap: () => {\n    Subway.selectAggregate(AGGREGATE_NAME)\n      .publicChannel()\n      .reactToCommand(\n        PublicCommands.NAVIGATE_TO_PRODUCT_DETAILS,\n        ({ payload }, { triggerEvents }) => {\n          triggerEvents([\n            {\n              id: Events.PRODUCT_PAGE_SELECTED,\n              payload\n            }\n          ]);\n        }\n      );\n\n    Subway.selectAggregate(AGGREGATE_NAME)\n      .publicChannel()\n      .reactToCommand(\n        PublicCommands.NAVIGATE_TO_CHECKOUT_PAGE,\n        ({ payload }, { triggerEvents }) => {\n          triggerEvents([\n            {\n              id: Events.CHECKOUT_PAGE_REQUEST_SUBMITTED,\n              payload\n            }\n          ]);\n        }\n      );\n  }\n};\n","export const Commands = {\n  LOAD_PRODUCTS_LIST: \"LoadProductsList\",\n};\n","import { AGGREGATE_NAME } from \"./index\";\nimport { Commands } from \"./verbs/commands\";\nimport { Subway } from \"../../subwayUtils/\";\n\nexport const loadProductsList = () => {\n  Subway.selectAggregate(AGGREGATE_NAME).command(\n    Commands.LOAD_PRODUCTS_LIST\n  );\n};\n\nexport const selectProductForDetails = product => {\n  const productAggregate = Subway.selectAggregate(AGGREGATE_NAME);\n  productAggregate.publicChannel().command(\"NAVIGATE_TO_PRODUCT_DETAILS\", { product });\n  productAggregate.command(\"SELECT_PRODUCT\", { product });\n};\n\nexport const triggerAddToShoppingCart = product => {\n  Subway.selectAggregate(AGGREGATE_NAME).publicChannel().command(\n    \"ADD_TO_SHOPPING_CART\",\n    { product }\n  );\n};\n","export const Events = {\n  PRODUCTS_LIST_LOADED: \"ProductsListLoaded\",\n};\n","export const data = [\n  {\n    id: 10,\n    img: \"images/products/air-jordan-1-i.jpg\",\n    title: \"Air Jordan I\",\n    price: \"199.00\",\n    newPrice: \"149.99\",\n    ccy: \"$\",\n    rating: \"5\",\n    reviewsCount: 54\n  },\n  {\n    id: 11,\n    img: \"images/products/air-jordan-original-2.jpg\",\n    title: \"Air Jordan II\",\n    price: \"199.00\",\n    newPrice: \"249.00\",\n    ccy: \"$\",\n    rating: \"4\",\n    reviewsCount: 12\n  },\n  {\n    id: 12,\n    img: \"images/products/air-jordan-3.jpg\",\n    title: \"Air Jordan III\",\n    price: \"199.00\",\n    ccy: \"$\",\n    rating: \"4\",\n    reviewsCount: 43\n  },\n  {\n    id: 13,\n    img: \"images/products/air-jordan-4.jpg\",\n    title: \"Air Jordan IV\",\n    price: \"199.00\",\n    ccy: \"$\",\n    rating: \"2\",\n    reviewsCount: 76\n  },\n  {\n    id: 14,\n    img: \"images/products/air-jordan-og-5-fire-red.jpeg\",\n    title: \"Air Jordan V\",\n    price: \"199.00\",\n    ccy: \"$\",\n    rating: \"5\",\n    reviewsCount: 23\n  },\n  {\n    id: 15,\n    img: \"images/products/air-jordan-6.jpg\",\n    title: \"Air Jordan VI\",\n    price: \"199.00\",\n    ccy: \"$\",\n    rating: \"4\",\n    reviewsCount: 54\n  },\n  {\n    id: 16,\n    img: \"images/products/air-jordan-7.jpg\",\n    title: \"Air Jordan VII\",\n    price: \"199.00\",\n    ccy: \"$\",\n    rating: \"2\",\n    reviewsCount: 13\n  },\n  {\n    id: 17,\n    img: \"images/products/air-jordan-8.jpg\",\n    title: \"Air Jordan VII\",\n    price: \"199.00\",\n    ccy: \"$\",\n    rating: \"4\",\n    reviewsCount: 43\n  },\n  {\n    id: 18,\n    img: \"images/products/air-jordan-9.jpg\",\n    title: \"Air Jordan IX\",\n    price: \"199.00\",\n    ccy: \"$\",\n    rating: \"4\",\n    reviewsCount: 55\n  },\n  {\n    id: 19,\n    img: \"images/products/air-jordan-10.jpg\",\n    title: \"Air Jordan X\",\n    price: \"199.00\",\n    ccy: \"$\",\n    rating: \"5\",\n    reviewsCount: 12\n  },\n  {\n    id: 20,\n    img: \"images/products/air-jordan-11.jpg\",\n    title: \"Air Jordan XI\",\n    price: \"199.00\",\n    newPrice: \"149.00\",\n    ccy: \"$\",\n    rating: \"5\",\n    reviewsCount: 23\n  },\n  {\n    id: 21,\n    img: \"images/products/air-jordan-12.jpg\",\n    title: \"Air Jordan XII\",\n    price: \"199.00\",\n    newPrice: \"149.00\",\n    ccy: \"$\",\n    rating: \"5\",\n    reviewsCount: 132\n  }\n];\n","import { Commands } from \"../verbs/commands\";\nimport { Events } from \"../verbs/events\";\n\nimport * as MockAPI from \"../api/mockApi\";\n\nexport const cmdLoadProductsListHandler = {\n  command: Commands.LOAD_PRODUCTS_LIST,\n  handler: async ({ state, payload }, { triggerEvents }) => {\n    const productsList = await MockAPI.getProductsList();\n    triggerEvents([{ id: Events.PRODUCTS_LIST_LOADED, payload: { productsList } }])\n  }\n};\n\nexport const cmdSelectProductForDetailsHandler = {\n  command: \"SELECT_PRODUCT\",\n  handler: ({ state, payload }, { triggerEvents }) => {\n    triggerEvents([\n      {\n        id: Events.PRODUCT_SELECTED_FOR_DETAILS,\n        payload: { product: payload.product }\n      }\n    ])\n  }\n};\n\nexport const cmdHandlers = [\n  cmdLoadProductsListHandler,\n  cmdSelectProductForDetailsHandler\n];\n","import { data } from \"./data\";\n\nconst RPC_FAKE_DELAY = 500;\nexport const getProductsList = () => {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      resolve(data.reverse());\n    }, RPC_FAKE_DELAY);\n  });\n};\n","import { Events } from \"../verbs/events\";\n\nexport const evtProductsListLoadedHandler = {\n  command: Events.PRODUCTS_LIST_LOADED,\n  handler: ({ state, payload = {} }, { updateState }) => {\n    const { productsList } = payload;\n    updateState({\n      ...state,\n      productsList\n    })\n  }\n};\n\n// TODO review communication messaging logic\nexport const evtProductSelectedForDetailsHandler = {\n  command: Events.PRODUCT_SELECTED_FOR_DETAILS,\n  handler: ({ state, payload = {} }, { updateState }) => {\n    const { product } = payload;\n    updateState({\n      ...state,\n      selectedProduct: product\n    })\n  }\n};\n\nexport const evtHandlers = [\n  evtProductsListLoadedHandler,\n  evtProductSelectedForDetailsHandler\n];\n","import React, { useState } from \"react\";\nimport { Button, Icon } from \"semantic-ui-react\";\n\nexport function AddToCartButton({ product, size, onClick }) {\n  const [loading, setLoading] = useState(false);\n  return (\n    <Button\n      size={size}\n      fluid\n      loading={loading}\n      color=\"teal\"\n      onClick={() => {\n        setLoading(true);\n        setTimeout(() => {\n          onClick(product);\n          setLoading(false);\n        }, 500);\n      }}\n    >\n      <Button.Content>\n        <Icon name=\"shop\" /> Add to cart\n      </Button.Content>\n    </Button>\n  );\n}\n","import React, { useState } from \"react\";\nimport {\n  Grid,\n  Image,\n  Label,\n  Icon,\n  Card,\n  Rating,\n  Button,\n  Dimmer\n} from \"semantic-ui-react\";\n\nimport { useObserveAggregateState } from \"../../../../subwayUtils/\";\n\nimport { AGGREGATE_NAME as PRODUCTS_AGGREGATE_NAME } from \"../../\";\n\nimport {\n  selectProductForDetails,\n  triggerAddToShoppingCart\n} from \"../../commandCreators\";\n\nimport { AddToCartButton } from \"../components/addToCartButton\";\n\nexport function ProductList() {\n  const [detailsButtonHoveredId, setDetailsButtonHoveredId] = useState(null);\n\n  const [productList] = useObserveAggregateState(\n    PRODUCTS_AGGREGATE_NAME,\n    aggregateState => aggregateState.productsList\n  );\n\n  return (\n    <Grid columns={3}>\n      {productList &&\n        productList.map(product => {\n          const {\n            id,\n            img,\n            title,\n            price,\n            rating,\n            reviewsCount,\n            newPrice = null,\n            ccy\n          } = product;\n          return (\n            <Grid.Column key={id}>\n              <Card>\n                {newPrice && (\n                  <Image\n                    fluid\n                    label={{\n                      as: \"a\",\n                      color: \"orange\",\n                      corner: \"left\",\n                      icon: \"star\"\n                    }}\n                  />\n                )}\n                <Dimmer.Dimmable\n                  style={{ padding: 40, backgroundColor: \"white\" }}\n                  as={Image}\n                  onMouseOver={() => {\n                    setDetailsButtonHoveredId(id);\n                  }}\n                  onMouseLeave={() => {\n                    setDetailsButtonHoveredId(null);\n                  }}\n                  dimmed={detailsButtonHoveredId === id}\n                >\n                  <Image src={img} wrapped />\n\n                  <Dimmer active={detailsButtonHoveredId === id}>\n                    <Button\n                      basic\n                      size=\"small\"\n                      color=\"teal\"\n                      onClick={() => selectProductForDetails(product)}\n                    >\n                      <Button.Content>\n                        <Icon name=\"magnify\" /> Product details\n                      </Button.Content>\n                    </Button>\n                  </Dimmer>\n                </Dimmer.Dimmable>\n                <Card.Content>\n                  <Card.Header as=\"a\">{title}</Card.Header>\n                  <Card.Meta>\n                    <Rating\n                      size=\"mini\"\n                      disabled\n                      icon=\"star\"\n                      defaultRating={rating}\n                      maxRating={5}\n                    />{\" \"}\n                    {reviewsCount} Reviews\n                  </Card.Meta>\n                  {newPrice && (\n                    <>\n                      <Card.Description>\n                        <strike>\n                          {ccy}\n                          {price}\n                        </strike>{\" \"}\n                        <Icon name=\"arrow right\" />{\" \"}\n                        <Label as=\"span\" color=\"orange\" tag>\n                          {ccy}\n                          {newPrice}\n                        </Label>\n                      </Card.Description>\n                    </>\n                  )}\n                  {!newPrice && (\n                    <Card.Description>\n                      {ccy}\n                      {price}{\" \"}\n                    </Card.Description>\n                  )}\n                </Card.Content>\n                <Card.Content extra>\n                  <AddToCartButton\n                    size=\"small\"\n                    product={product}\n                    onClick={triggerAddToShoppingCart}\n                  />\n                  {\n                    // <Button size=\"small\" fluid color=\"teal\">\n                    //   <Button.Content>\n                    //     <Icon name=\"shop\" /> Add to cart\n                    //   </Button.Content>\n                    // </Button>\n                  }\n                </Card.Content>\n              </Card>\n            </Grid.Column>\n          );\n        })}\n    </Grid>\n  );\n}\n","import React from \"react\";\nimport {\n  Segment,\n  Image,\n  Header,\n  Container,\n  Rating,\n  Divider,\n  Icon,\n  Label\n} from \"semantic-ui-react\";\n\nimport { AGGREGATE_NAME as PRODUCTS_AGGREGATE_NAME } from \"../../\";\n\nimport { useObserveAggregateState } from \"../../../../subwayUtils/\";\nimport { AddToCartButton } from \"../components/addToCartButton\";\nimport { triggerAddToShoppingCart } from \"../../commandCreators\";\n\nexport function ProductDetails() {\n  const [product] = useObserveAggregateState(\n    PRODUCTS_AGGREGATE_NAME,\n    aggregateState => aggregateState.selectedProduct\n  );\n\n  return (\n    <>\n      {\" \"}\n      {product && (\n        <Segment.Group horizontal>\n          <Segment padded=\"very\">\n            <Image src={product.img} wrapped />\n\n            <Segment.Group horizontal compact>\n              {[1, 2, 3].map(i => (\n                <Segment key={i} basic>\n                  <Image src={product.img} size=\"tiny\" />\n                </Segment>\n              ))}\n            </Segment.Group>\n          </Segment>\n          <Segment>\n            <Header size=\"huge\">\n              {product.title}{\" \"}\n              {product.newPrice && (\n                <Label as=\"span\" color=\"orange\" tag>\n                  ON SALE\n                </Label>\n              )}\n            </Header>\n            <Container>\n              <Rating\n                disabled\n                icon=\"star\"\n                defaultRating={product.rating}\n                maxRating={5}\n              />{\" \"}\n              {product.reviewsCount} Reviews\n            </Container>\n            <br />\n            <Container>\n              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do\n              eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut\n              enim ad minim veniam, quis nostrud exercitation ullamco laboris\n              nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in\n              reprehenderit in voluptate velit esse cillum dolore eu fugiat\n              nulla pariatur. Excepteur sint occaecat cupidatat non proident,\n              sunt in culpa qui officia deserunt mollit anim id est laborum.\n            </Container>\n\n            <br />\n\n            {product.newPrice && (\n              <>\n                <Label as=\"span\" color=\"grey\" basic size=\"huge\">\n                  <strike>\n                    {product.ccy}\n                    {product.price}\n                  </strike>\n                </Label>\n                <Icon name=\"arrow right\" size=\"big\" />\n                <Label as=\"span\" color=\"orange\" size=\"huge\">\n                  {product.ccy}\n                  {product.newPrice}\n                </Label>\n              </>\n            )}\n            {!product.newPrice && (\n              <Header size=\"huge\">\n                {product.ccy}\n                {product.price}\n              </Header>\n            )}\n\n            <Divider />\n            <AddToCartButton\n              size=\"huge\"\n              product={product}\n              onClick={triggerAddToShoppingCart}\n            />\n            {\n              // <Button size=\"huge\" fluid color=\"teal\">\n              //   <Button.Content>\n              //     <Icon name=\"shop\" /> Add to cart\n              //   </Button.Content>\n              // </Button>\n            }\n          </Segment>\n        </Segment.Group>\n      )}\n    </>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { Message, Transition } from \"semantic-ui-react\";\n\nconst messages = [\n  \"This is NOT a real ecommerce\",\n  \"Prices and ratings are not real\",\n  \"All product and company names are trademarks™ or registered® trademarks of their respective holders. Use of them does not imply any affiliation with or endorsement by them.\"\n];\n\nexport function Disclaimer() {\n  const [visible, setVisible] = useState(false);\n  useEffect(() => {\n    setTimeout(() => {\n      setVisible(true);\n    }, 4000);\n  }, []);\n\n  const handleDismiss = () => {\n    setVisible(false);\n  };\n\n  return (\n    <Transition visible={visible} animation=\"fade up\" duration={500}>\n      <Message\n        color=\"teal\"\n        size=\"tiny\"\n        onDismiss={handleDismiss}\n        style={{\n          position: \"fixed\",\n          zIndex: 10,\n          bottom: 0,\n          right: 0,\n          width: \"100%\"\n        }}\n        header=\"Disclaimer\"\n        list={messages}\n      />\n    </Transition>\n  );\n}\n","import { loadProductsList } from \"./commandCreators\";\n\nimport { cmdHandlers } from \"./handlers/commands\";\nimport { evtHandlers } from \"./handlers/events\";\n\nexport const AGGREGATE_NAME = \"ProductsAggregate\";\nconst initialState = {\n  productsList: [],\n  selectedProduct: null\n};\n\nexport { ProductList } from \"./ui/containers/productList\";\nexport { ProductDetails } from \"./ui/containers/productDetails\";\nexport { Disclaimer } from \"./ui/components/disclaimer\";\n\nexport const aggregateConfig = {\n  name: AGGREGATE_NAME,\n  initialState,\n  cmdHandlers,\n  evtHandlers,\n  bootstrap: () => loadProductsList()\n};\n","export const Events = {\n  PRODUCT_ADDED_TO_CART: \"PRODUCT_ADDED_TO_CART\",\n  ORDER_PROCESSED: \"ORDER_PROCESSED\"\n};\n","export const PublicCommands = {\n  ADD_TO_SHOPPING_CART: \"ADD_TO_SHOPPING_CART\",\n};\n","export const Commands = {\n  SUBMIT_ORDER: \"SUBMIT_ORDER\"\n};\n","import { Commands } from \"../verbs/commands\";\nimport { Events } from \"../verbs/events\";\nimport * as MockAPI from \"../api/mockApi\";\n\nexport const cmdSubmitOrderHandler = {\n  command: Commands.SUBMIT_ORDER,\n  handler: async ({ state, payload }, { triggerEvents }) => {\n    const { items } = payload;\n    const orderSubmissionResult = await MockAPI.submitSuccessfulOrder(items);\n    let events = [];\n    const { status } = orderSubmissionResult;\n    if (status === \"ok\") {\n      events = events.concat([\n        {\n          id: Events.ORDER_PROCESSED,\n          payload: { successful: true, items }\n        }\n      ]);\n    }\n\n    triggerEvents(events);\n  }\n};\n\nexport const cmdHandlers = [cmdSubmitOrderHandler];\n","const RPC_FAKE_DELAY = 1000;\nexport const submitSuccessfulOrder = items => {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      resolve({ status: \"ok\" });\n    }, RPC_FAKE_DELAY);\n  });\n};\n","import { Events } from \"../verbs/events\";\n\nexport const evtProductAddedToCartHandler = {\n  command: Events.PRODUCT_ADDED_TO_CART,\n  handler: ({ state, payload }, { updateState }) => {\n    const { product } = payload;\n    // TODO change to add products count and total\n    // const items = state.items.concat(product);\n\n    const { items } = state;\n    if (items.has(product.id)) {\n      const prod = items.get(product.id);\n      items.set(product.id, { ...product, count: prod.count + 1 });\n    } else {\n      items.set(product.id, { ...product, count: 1 });\n    }\n    updateState({\n        ...state,\n        items,\n        checkoutSuccessful: false\n      })\n  }\n};\n\nexport const evtOrderProcessedHandler = {\n  command: Events.ORDER_PROCESSED,\n  handler: ({ state, payload }, { updateState }) => {\n    const { successful } = payload;\n    // TODO check successful = fakse\n    updateState({\n        checkoutSuccessful: successful,\n        items: new Map()\n      })\n  }\n};\n\nexport const evtHandlers = [\n  evtProductAddedToCartHandler,\n  evtOrderProcessedHandler\n];\n","import React from \"react\";\nimport {\n  Button,\n  Popup,\n  Header,\n  Icon,\n  Segment,\n  Item,\n  Label\n} from \"semantic-ui-react\";\nimport { AGGREGATE_NAME as SHOPPING_CART_AGGREGATE_NAME } from \"../../\";\nimport { useObserveAggregateState } from \"../../../../subwayUtils/\";\nimport { goToCheckout } from \"../../commandCreators\";\n\nexport function HeaderShoppingCartDropdown({ size }) {\n  const [shoppingData] = useObserveAggregateState(\n    SHOPPING_CART_AGGREGATE_NAME,\n    aggregateState => aggregateState || {}\n  );\n  const { items = new Map() } = shoppingData || {};\n  const cartItems = Array.from(items).map(item => ({ ...item[1] }));\n  const itemsTotal = cartItems.reduce((acc, curr) => +acc + +curr.count, 0);\n  return (\n    <Popup\n      on=\"click\"\n      position=\"bottom right\"\n      trigger={\n        <Button color=\"teal\" icon>\n          <Icon name=\"shopping cart\" />\n          {itemsTotal > 0 && `    (${itemsTotal})`}\n        </Button>\n      }\n    >\n      <Popup.Content>\n        {(!cartItems || cartItems.length === 0) && (\n          <Segment basic textAlign=\"center\">\n            <Icon name=\"frown outline\" size=\"big\" color=\"teal\" />\n            <Header size=\"tiny\">\n              <Header.Subheader>Your shopping cart is empty</Header.Subheader>\n            </Header>\n          </Segment>\n        )}\n        {cartItems && cartItems.length > 0 && (\n          <Item.Group divided>\n            {cartItems.map(\n              ({ id, img, title, price, newPrice, ccy, count }) => (\n                <Item key={id}>\n                  <Item.Image size=\"mini\" src={img} />\n\n                  <Item.Content>\n                    <Item.Description>\n                      {count && count > 1 && (\n                        <Label circular size=\"tiny\" color=\"black\">\n                          x{count}\n                        </Label>\n                      )}{\" \"}\n                      {title}\n                    </Item.Description>\n                    <Item.Meta>\n                      <span className=\"price\">\n                        {ccy}\n                        {(newPrice || price) * count}\n                      </span>\n                    </Item.Meta>\n                  </Item.Content>\n                </Item>\n              )\n            )}\n            <Item>\n              <Item.Header as=\"h4\">\n                Total: {cartItems[0].ccy}{\" \"}\n                {cartItems\n                  .reduce(\n                    (acc, curr) =>\n                      +acc + +((curr.newPrice || curr.price) * curr.count),\n                    0\n                  )\n                  .toFixed(2)}\n              </Item.Header>\n            </Item>\n\n            <Item>\n              <Item.Content>\n                <Button fluid color=\"teal\" onClick={() => goToCheckout()}>\n                  Checkout\n                </Button>\n              </Item.Content>\n            </Item>\n          </Item.Group>\n        )}\n      </Popup.Content>\n    </Popup>\n  );\n}\n","import { AGGREGATE_NAME } from \"./index\";\nimport { Commands } from \"./verbs/commands\";\nimport { Subway } from \"../../subwayUtils/\";\n\nexport const addProductToCart = product => {\n  Subway.selectAggregate(AGGREGATE_NAME).command(\n    Commands.ADD_PRODUCT_TO_CART,\n    { product }\n  );\n};\n\nexport const goToCheckout = product => {\n  Subway.selectAggregate(AGGREGATE_NAME).publicChannel().command(\n    \"NAVIGATE_TO_CHECKOUT_PAGE\"\n  );\n};\n\nexport const showLoginScreen = () => {\n  Subway.selectAggregate(AGGREGATE_NAME).publicChannel().command(\"SHOW_LOGIN_MODAL\");\n};\n\nexport const submitSuccessfulOrder = items => {\n  Subway.selectAggregate(AGGREGATE_NAME).command(Commands.SUBMIT_ORDER, {\n    items\n  });\n};\n","import React, { useState, useEffect } from \"react\";\nimport {\n  Table,\n  Label,\n  Header,\n  Message,\n  Button,\n  Icon,\n  Image\n} from \"semantic-ui-react\";\n\nimport { AGGREGATE_NAME as SHOPPING_CART_AGGREGATE_NAME } from \"../../\";\nimport {\n  useObserveAggregateState,\n  useReactToEvent\n} from \"../../../../subwayUtils/\";\nimport { showLoginScreen, submitSuccessfulOrder } from \"../../commandCreators\";\n\nexport function Checkout() {\n  const [loading, setLoading] = useState(false);\n  const [checkoutCompleted, setCheckoutCompleted] = useState(false);\n  const [state] = useObserveAggregateState(SHOPPING_CART_AGGREGATE_NAME);\n  const {\n    items: shoppingMap = [],\n    checkoutSuccessful: orderSuccessful = false\n  } = state ? state : {};\n\n  const [userLoggedInPayload] = useReactToEvent(SHOPPING_CART_AGGREGATE_NAME, \"SESSION_STATUS_UPDATED\");\n  const { userLogged, username } = userLoggedInPayload || {};\n\n  useEffect(() => {\n    setCheckoutCompleted(orderSuccessful);\n    setLoading(false);\n  }, [orderSuccessful]);\n\n  const list = Array.from(shoppingMap || []).map(item => ({ ...item[1] }));\n  const totalCurrency = list[0] ? list[0].ccy : null;\n  const count = list.reduce((acc, curr) => +acc + +curr.count, 0);\n  const total = list\n    .reduce(\n      (acc, curr) => +acc + +((curr.newPrice || curr.price) * curr.count),\n      0\n    )\n    .toFixed(2);\n\n  if (!loading && checkoutCompleted) {\n    return (\n      <Header\n        color=\"teal\"\n        style={{ marginTop: 100 }}\n        as=\"h2\"\n        icon\n        textAlign=\"center\"\n      >\n        <Icon name=\"winner\" />\n        Order processed successfully!\n        <Header.Subheader>\n          Thanks {username}! You will receive your products tomorrow!\n        </Header.Subheader>\n      </Header>\n    );\n  }\n  return (\n    <>\n      <div>{loading}</div>\n      <Table columns={4} color=\"teal\">\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell width={5}>PRODUCT</Table.HeaderCell>\n            <Table.HeaderCell textAlign=\"center\">QUANTITY</Table.HeaderCell>\n            <Table.HeaderCell width={5} textAlign=\"center\">\n              UNIT PRICE\n            </Table.HeaderCell>\n            <Table.HeaderCell width={5} textAlign=\"right\">\n              TOTAL\n            </Table.HeaderCell>\n          </Table.Row>\n        </Table.Header>\n\n        <Table.Body>\n          {list.map(({ id, title, count, newPrice, price, ccy, img }) => (\n            <Table.Row key={id}>\n              <Table.Cell>\n                {newPrice && (\n                  <Label color=\"orange\" size=\"mini\" ribbon>\n                    OFFER!\n                  </Label>\n                )}\n                {title} <Image src={img} size=\"mini\" />\n              </Table.Cell>\n\n              <Table.Cell textAlign=\"center\"> {count}</Table.Cell>\n              <Table.Cell textAlign=\"center\">\n                <Header as=\"h5\">\n                  <Header.Content>\n                    {newPrice || price} {ccy}\n                    {newPrice && (\n                      <Header.Subheader\n                        style={{ textDecoration: \"line-through\" }}\n                      >\n                        {price} {ccy}\n                      </Header.Subheader>\n                    )}\n                  </Header.Content>\n                </Header>\n              </Table.Cell>\n              <Table.Cell positive textAlign=\"right\">\n                <Header as=\"h4\">\n                  <Header.Content>\n                    {((newPrice || price) * count).toFixed(2)} {ccy}\n                  </Header.Content>\n                </Header>\n              </Table.Cell>\n            </Table.Row>\n          ))}\n        </Table.Body>\n\n        <Table.Footer>\n          <Table.Row>\n            <Table.HeaderCell />\n            <Table.HeaderCell textAlign=\"center\">\n              {count} articles\n            </Table.HeaderCell>\n            <Table.HeaderCell />\n            <Table.HeaderCell positive textAlign=\"right\">\n              {total} {totalCurrency}\n            </Table.HeaderCell>\n          </Table.Row>\n        </Table.Footer>\n      </Table>\n\n      <Message color=\"teal\" attached>\n        <Header as=\"h4\">\n          {username\n            ? `Hi ${username}, you can buy in one click!`\n            : \"Buy in one click\"}\n          <Header.Subheader>\n            Pay with your default paying method and receive tomorrow at your\n            home address.\n          </Header.Subheader>\n        </Header>\n        <br />\n\n        {!checkoutCompleted && !loading && userLogged && (\n          <Button\n            color=\"orange\"\n            floated=\"right\"\n            onClick={() => {\n              setLoading(true);\n              submitSuccessfulOrder(list);\n            }}\n          >\n            Buy in 1-click!\n          </Button>\n        )}\n        {!checkoutCompleted && !loading && !userLogged && (\n          <Button\n            animated=\"fade\"\n            color=\"teal\"\n            floated=\"right\"\n            onClick={() => showLoginScreen()}\n          >\n            <Button.Content visible>Buy in 1-click!</Button.Content>\n            <Button.Content hidden>Login first</Button.Content>\n          </Button>\n        )}\n        {!checkoutCompleted && loading && (\n          <Button color=\"orange\" disabled floated=\"right\" loading>\n            Buy in 1-click!\n          </Button>\n        )}\n        {!loading && checkoutCompleted && \"FINALIZED\"}\n\n        <br />\n        <br />\n      </Message>\n      {!userLogged && (\n        <Message attached=\"bottom\" warning>\n          <Icon name=\"info\" />\n          If you are not logged in, we will ask for your credentials before\n          proceeding with the order\n        </Message>\n      )}\n    </>\n  );\n}\n","import React from 'react';\n\nimport { Subway } from \"../../subwayUtils/\";\n\n// import { addProductToCart } from \"./commandCreators\";\nimport { Events } from \"./verbs/events\";\nimport { PublicCommands } from \"./verbs/public\";\n\nimport { cmdHandlers } from \"./handlers/commands\";\nimport { evtHandlers } from \"./handlers/events\";\n\nimport { HeaderShoppingCartDropdown } from \"./ui/containers/headerShoppingCartDropdown\";\n\nexport const AGGREGATE_NAME = \"ShoppingCartAggregate\";\n\nexport {\n  HeaderShoppingCartDropdown\n} from \"./ui/containers/headerShoppingCartDropdown\";\nexport { Checkout } from \"./ui/containers/checkout\";\n\nexport const aggregateConfig = {\n  name: AGGREGATE_NAME,\n  initialState: { checkoutSuccessful: null, items: new Map() },\n  cmdHandlers,\n  evtHandlers,\n  bootstrap: () => {\n  \n    Subway.selectAggregate(AGGREGATE_NAME).publicChannel().reactToCommand(\n      PublicCommands.ADD_TO_SHOPPING_CART,\n      ({ payload }, { triggerEvents }) => {\n        triggerEvents([\n            {\n              id: Events.PRODUCT_ADDED_TO_CART,\n              payload\n            }\n          ])\n      }\n    );\n  }\n};\n","export const Events = {\n  LOGIN_MODAL_VISIBILITY_UPDATED: \"LOGIN_MODAL_VISIBILITY_UPDATED\",\n  LOGIN_MODAL_REQUESTED: \"LOGIN_MODAL_REQUESTED\",\n  LOGOUT_USER_REQUESTED: \"LOGOUT_USER_REQUESTED\",\n  USER_LOGGED_OUT: \"USER_LOGGED_OUT\",\n  USER_SUCCESSFULLY_AUTHENTICATED: \"USER_SUCCESSFULLY_AUTHENTICATED\",\n  SESSION_STATUS_UPDATED: \"SESSION_STATUS_UPDATED\"\n};\n","export const Commands = {\n  UPDATE_LOGIN_MODAL_VISIBILITY: \"UPDATE_LOGIN_MODAL_VISIBILITY\",\n\n  AUTHENTICATE_USER: \"AUTHENTICATE_USER\",\n};\n","export const PublicCommands = {\n  SHOW_LOGIN_MODAL: \"SHOW_LOGIN_MODAL\",\n  PERFORM_USER_LOGOUT: \"PERFORM_USER_LOGOUT\"\n};\n","const RPC_FAKE_DELAY = 1000;\n\nconst FAKE_ACCOUNT = {\n  username: 'MichaelJordan23',\n  password: 'air23'\n}\nexport const authenticate = (username, password) => {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      if(username === FAKE_ACCOUNT.username && password === FAKE_ACCOUNT.password) {\n        resolve({ status: \"ok\", jwt: \"fake.jwt.token\" });\n      } else {\n        resolve({ status: \"ko\", message: \"wrong credentials\" });\n      }\n    }, RPC_FAKE_DELAY);\n  });\n};\n","import { Commands } from \"../verbs/commands\";\nimport { Events } from \"../verbs/events\";\nimport * as MockAPI from \"../api/mockApi\";\n\nexport const cmdHideLoginScreenHandler = {\n  command: Commands.UPDATE_LOGIN_MODAL_VISIBILITY,\n  handler: ({ state, payload }, { triggerEvents }) =>\n    triggerEvents([{ id: Events.LOGIN_MODAL_VISIBILITY_UPDATED, payload }])\n};\n\nexport const cmdAuthenticateUserHandler = {\n  command: Commands.AUTHENTICATE_USER,\n  handler: async ({ state, payload }, { triggerEvents, rejectCommand }) => {\n    const { username, password } = payload;\n    const authenticationResult = await MockAPI.authenticate(username, password);\n    let events = [];\n    const { status } = authenticationResult;\n    if (status === \"ok\") {\n      const { jwt } = authenticationResult;\n      events = events.concat([\n        {\n          id: Events.USER_SUCCESSFULLY_AUTHENTICATED,\n          payload: { jwt, username }\n        }\n      ]);\n    }\n    if(status === 'ko') {\n      rejectCommand('Authentication failed', authenticationResult.message)\n      return;\n    }\n\n    triggerEvents(events)\n  }\n};\n\nexport const cmdHandlers = [\n  cmdHideLoginScreenHandler,\n  cmdAuthenticateUserHandler\n];\n","import { Events } from \"../verbs/events\";\n\nexport const evtUpdateLoginModalVisibilityHandler = {\n  command: Events.LOGIN_MODAL_VISIBILITY_UPDATED,\n  handler: ({ state, payload }, { updateState }) => {\n    updateState({\n      ...state,\n      loginModalVisible: payload.show\n    })\n  }\n};\n\nexport const evtLoginModalRequestedHandler = {\n  command: Events.LOGIN_MODAL_REQUESTED,\n  handler: ({ state, payload }, { triggerEvents }) => {\n    triggerEvents([\n      { id: Events.LOGIN_MODAL_VISIBILITY_UPDATED, payload: { show: true } }\n    ])\n  }\n};\n\nexport const evtLogoutUserRequestedHandler = {\n  command: Events.LOGOUT_USER_REQUESTED,\n  handler: ({ state, payload }, { triggerEvents, updateState, broadcastEvent }) => {\n    broadcastEvent(Events.SESSION_STATUS_UPDATED, {\n      userLogged: false,\n    });\n    updateState({\n      ...state,\n      userLogged: false,\n      jwt: null,\n      username: null\n    })\n    triggerEvents([{\n      id: Events.SESSION_STATUS_UPDATED,\n      payload: {\n        userLoggedIn: false,\n      }\n    }])\n  }\n};\n\nexport const evtUserSuccessfullyAuthenticatedHandler = {\n  command: Events.USER_SUCCESSFULLY_AUTHENTICATED,\n  handler: ({ state, payload }, { triggerEvents, updateState, broadcastEvent }) => {\n    const { jwt, username } = payload;\n\n    broadcastEvent(Events.SESSION_STATUS_UPDATED, {\n      userLogged: true,\n      username\n    });\n    updateState({\n      ...state,\n      userLogged: true,\n      loginModalVisible: false,\n      jwt,\n      username\n    })\n    triggerEvents([{\n      id: Events.SESSION_STATUS_UPDATED,\n      payload: {\n        userLogged: true,\n        username\n      }\n    }]) \n  }\n};\n\nexport const evtHandlers = [\n  evtUpdateLoginModalVisibilityHandler,\n  evtLoginModalRequestedHandler,\n  evtUserSuccessfullyAuthenticatedHandler,\n  evtLogoutUserRequestedHandler\n];\n","import { AGGREGATE_NAME } from \"./index\";\nimport { Commands } from \"./verbs/commands\";\nimport { Subway } from \"../../subwayUtils/\";\n\nexport const showLoginScreen = () => {\n  Subway.selectAggregate(AGGREGATE_NAME).command(\n    Commands.UPDATE_LOGIN_MODAL_VISIBILITY,\n    { show: true }\n  );\n};\n\nexport const hideLoginScreen = () => {\n  Subway.selectAggregate(AGGREGATE_NAME).command(\n    Commands.UPDATE_LOGIN_MODAL_VISIBILITY,\n    { show: false }\n  );\n};\n\nexport const simulateLogin = (username, password, onRejected) => {\n  Subway.selectAggregate(AGGREGATE_NAME).command(\n    Commands.AUTHENTICATE_USER,\n    { username, password },\n    onRejected\n  );\n};\n","import React, { useState, useEffect } from \"react\";\nimport { Button, Header, Icon, Modal, Form } from \"semantic-ui-react\";\nimport { useObserveAggregateState } from \"../../../../subwayUtils\";\nimport {\n  hideLoginScreen,\n  simulateLogin\n} from \"../../commandCreators\";\n\nexport function LoginModal() {\n  const [authInProgress, setAuthInProgress] = useState(false);\n  const [wrongCredentials, setWrongCredentials] = useState(false);\n  const [isLoginModalVisible] = useObserveAggregateState(\n    \"SessionAggregate\",\n    aggregateState => aggregateState.loginModalVisible\n  );\n\n  useEffect(() => {\n    setAuthInProgress(false);\n    setWrongCredentials(false);\n  }, [isLoginModalVisible]);\n\n  return (\n    <Modal\n      open={isLoginModalVisible}\n      dimmer=\"blurring\"\n      size=\"small\"\n      onClose={() => hideLoginScreen()}\n    >\n      {!wrongCredentials && <Header color=\"teal\" icon=\"user\" content=\"Enter your credentials\" />}\n      {wrongCredentials && <Header color=\"red\" icon=\"user\" content=\"Wrong credentials: try again\" />}\n\n      <Modal.Content>\n        <Form>\n          <Form.Field>\n            <Form.Input disabled value=\"testuser\" label=\"Enter Username\" />\n          </Form.Field>\n          <Form.Field>\n            <Form.Input\n              disabled\n              value=\"password\"\n              label=\"Enter Password\"\n              type=\"password\"\n            />\n          </Form.Field>\n        </Form>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button\n          disabled={authInProgress}\n          color=\"grey\"\n          onClick={() => hideLoginScreen()}\n        >\n          <Icon name=\"cancel\" /> Cancel\n        </Button>\n\n        <Button\n          loading={authInProgress}\n          disabled={authInProgress}\n          color=\"teal\"\n          onClick={() => {\n            setAuthInProgress(true);\n            simulateLogin(\"MichaelJordan23\", \"wrongPassword\", ({ reasonString, meta }) => {\n              setWrongCredentials(true);\n              setAuthInProgress(false);\n            });\n          }}\n        >\n          <Icon name=\"checkmark\" /> Simulate wrong credentials\n        </Button>\n\n        <Button\n          loading={authInProgress}\n          disabled={authInProgress}\n          color=\"teal\"\n          onClick={() => {\n            setAuthInProgress(true);\n            simulateLogin(\"MichaelJordan23\", \"air23\");\n          }}\n        >\n          <Icon name=\"checkmark\" /> Simulate Successful Login\n        </Button>\n      </Modal.Actions>\n    </Modal>\n  );\n}\n","import { Subway } from \"../../subwayUtils/\";\nimport { Events } from \"./verbs/events\";\nimport { Commands } from \"./verbs/commands\";\nimport { PublicCommands } from \"./verbs/public\";\n\nimport { cmdHandlers } from \"./handlers/commands\";\nimport { evtHandlers } from \"./handlers/events\";\n\nexport const AGGREGATE_NAME = \"SessionAggregate\";\nexport const initialState = {\n  userLogged: false,\n  loginModalVisible: false,\n  jwt: null,\n  username: null\n};\n\nexport const aggregateConfig = {\n  name: AGGREGATE_NAME,\n  initialState,\n  cmdHandlers,\n  evtHandlers,\n  bootstrap: () => {\n    Subway.selectAggregate(AGGREGATE_NAME).publicChannel().reactToCommand(\n      PublicCommands.SHOW_LOGIN_MODAL,\n      ({ payload }, { triggerEvents }) => {\n        triggerEvents([\n            {\n              id: Events.LOGIN_MODAL_REQUESTED\n            }\n          ])\n      }\n    );\n\n    Subway.selectAggregate(AGGREGATE_NAME).publicChannel().reactToCommand(\n      PublicCommands.PERFORM_USER_LOGOUT,\n      ({ payload }, { triggerEvents }) => {\n        triggerEvents([\n            {\n              id: Events.LOGOUT_USER_REQUESTED\n            }\n          ])\n      }\n    );\n  }\n};\n\nexport { LoginModal } from \"./ui/containers/loginModal\";\n","import React from \"react\";\nimport { Container } from \"semantic-ui-react\";\nimport { Subway } from \"./subwayUtils\";\nimport { useObserveAggregateState } from \"./subwayUtils/\";\n\nimport { Navbar, Breadcrumbs } from \"./aggregates/navigation\";\nimport { ProductList, ProductDetails, Disclaimer } from \"./aggregates/products\";\nimport { Checkout, HeaderShoppingCartDropdown } from \"./aggregates/shoppingCart\";\n\nimport { LoginModal } from \"./aggregates/session\";\nfunction App() {\n  const [currentPage] = useObserveAggregateState(\n    \"NavigationAggregate\",\n    aggregateState => aggregateState.currentPage\n  );\n\n  return (\n    <div style={{ background: \"#f8f9fa\" }}>\n      <Container>\n        <LoginModal />\n        <Navbar shoppingCartMenuItem={<HeaderShoppingCartDropdown />} />\n        <br />\n        <br />\n        <br />\n        <br />\n        <Breadcrumbs />\n        <br />\n        <br />\n        {(!currentPage || currentPage === \"home\") && <ProductList />}\n        {currentPage === \"product\" && <ProductDetails />}\n        {currentPage === \"checkout\" && <Checkout />}\n\n        <Disclaimer />\n      </Container>\n    </div>\n  );\n}\n\nexport default App;\n","import { Subway } from \"./\";\n\nexport const initHandlers = (aggregate, cmdHandlers, evtHandlers) => {\n  cmdHandlers &&\n    cmdHandlers.forEach(({ command, handler, onError = null }) => {\n      aggregate.reactToCommand(command, handler, onError);\n    });\n  evtHandlers &&\n    evtHandlers.forEach(({ command, handler, onError = null }) => {\n      aggregate.reactToEvent(command, handler, onError);\n    });\n};\n\n// NOTE provide helper in the library itself?\nexport const initAggregates = aggregates => {\n  aggregates.forEach(\n    ({ name, initialState = {}, cmdHandlers = [], evtHandlers = []}) => {\n      const _agg = Subway.createAggregate(name, initialState);\n      initHandlers(_agg, cmdHandlers, evtHandlers);\n    }\n  );\n  aggregates.forEach(({ bootstrap = () => {} }) => bootstrap());\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { initAggregates } from \"./subwayUtils\";\nimport { aggregateConfig as productAggregateConfig } from \"./aggregates/products\";\nimport { aggregateConfig as navigationAggregateConfig } from \"./aggregates/navigation\";\nimport { aggregateConfig as shoppingCartAggregateConfig } from \"./aggregates/shoppingCart\";\nimport { aggregateConfig as sessionAggregateConfig } from \"./aggregates/session\";\n\n// TODO move to SubwayJS utils?\ninitAggregates([\n  sessionAggregateConfig,\n  productAggregateConfig,\n  navigationAggregateConfig,\n  shoppingCartAggregateConfig\n]);\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}