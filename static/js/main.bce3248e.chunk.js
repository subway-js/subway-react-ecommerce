(this["webpackJsonpsubway-react-ecommerce"]=this["webpackJsonpsubway-react-ecommerce"]||[]).push([[0],{177:function(e,t,a){e.exports=a(337)},337:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(32),l=a.n(c),i=a(16),o=a(341),u=window.Subway,m=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Object(n.useState)(null),c=Object(i.a)(r,2),l=c[0],o=c[1];return Object(n.useEffect)((function(){console.log(">>>> useObserveAggregateState init");var n=u.selectAggregate(e).observeState({next:function(e){var n=e.nextState;o(t(n)),a&&c()}}),r=n.currentState,c=n.unsubscribe;return o(t(r)),function(){try{c()}catch(e){}}}),[]),[l]},s="PRODUCT_PAGE_SELECTED",d="HOME_PAGE_SELECTED",g="SELECT_HOME_PAGE",E=[{command:g,handler:function(){return{events:[{id:d}]}}}],p=a(19),f=[{command:d,handler:function(e){return{proposal:Object(p.a)({},e,{currentPage:"home"})}}},{command:s,handler:function(e){return{proposal:Object(p.a)({},e,{currentPage:"product"})}}}],v=a(348),b=a(349);function h(e){var t=e.shoppingCartMenuItem;return r.a.createElement(v.a,{pointing:!0,secondary:!0,color:"teal",fixed:"top",style:{background:"white"}},r.a.createElement(o.a,null,r.a.createElement(v.a.Item,null,r.a.createElement(b.a,{as:"h2",color:"teal"},"SubwayJS eComm")),r.a.createElement(v.a.Item,{position:"right"},t)))}var w=a(351),C=a(352),P=a(347),y=function(){u.selectAggregate(A).sendCommand(g)};function O(){var e=function(e,t,a){var r=Object(n.useState)(null),c=Object(i.a)(r,2),l=c[0],o=c[1];return Object(n.useEffect)((function(){var n=u.selectAggregate(e).spy(t,{next:function(e){o(a(e))}});return function(){n()}}),[]),[l]}("ProductsAggregate","ProductSelectedForDetails",(function(e){var t=e.product;return{id:t.id,title:t.title}})),t=Object(i.a)(e,1)[0],a=m(A,(function(e){return e.currentPage})),c=Object(i.a)(a,1)[0];return r.a.createElement(w.a,{relaxed:!0,columns:2},r.a.createElement(w.a.Column,null,r.a.createElement(C.a,null,"home"===c&&r.a.createElement(C.a.Section,{active:!0},"Products"),"product"===c&&t&&t.id&&t.title&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a.Section,{active:!0,link:!0,onClick:function(){return y()}},"Products"),r.a.createElement(C.a.Divider,null),r.a.createElement(C.a.Section,{active:!0},t.title)))),"product"===c&&r.a.createElement(w.a.Column,{textAlign:"right"},r.a.createElement(P.a,{onClick:function(){return y()},size:"tiny",content:"Back to products",icon:"angle left",color:"teal",labelPosition:"left"})))}var A="NavigationAggregate",S={name:A,initialState:{currentPage:"home"},cmdHandlers:E,evtHandlers:f,bootstrap:function(){u.selectAggregate("ProductsAggregate").triggerAfter("ProductSelectedForDetails",{targetAggregate:A,triggeredEvent:s})}},j="LoadProductsList",k="SelectProductForDetails",D="TriggerAddToShoppingCart",z=function(e){u.selectAggregate(Q).sendCommand(D,{product:e})},L=a(95),T=a.n(L),H="ProductsListLoaded",x="ProductSelectedForDetails",R="ADD_TO_SHOPPING_CART_TRIGGERED",_=[{id:1,img:"images/products/11.jpg",title:"GoPro HERO7 Camera",price:"299.00",ccy:"$",rating:"4",reviewsCount:132},{id:2,img:"images/products/5.jpg",title:"Leather Sleeve - Macbook 13\u2019\u2019",price:"3753.00",newPrice:"3099.00",ccy:"$",rating:"4",reviewsCount:56},{id:3,img:"images/products/4.jpg",title:"Fj\xe4llr\xe4ven K\xe5nken Backpack Blue Ridge",price:"84.00",ccy:"$",rating:"5",reviewsCount:85},{id:4,img:"images/products/12.jpg",title:"Off-White Odsy-1000 Low-Top Sneakers",price:"815.00",newPrice:"799.00",ccy:"$",rating:"4",reviewsCount:422},{id:5,img:"images/products/9.jpg",title:"Logitech - Headset for gaming",price:"19.00",newPrice:"14.99",ccy:"$",rating:"3",reviewsCount:23},{id:6,img:"images/products/10.jpg",title:"Apple Homkit - Ecobee3 Lite Smart Thermostat",price:"169.95",ccy:"$",rating:"4",reviewsCount:198}],G=[{command:j,handler:function(e,t){var a;return T.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.awrap(new Promise((function(e,t){setTimeout((function(){e(_)}),500)})));case 2:return a=e.sent,e.abrupt("return",{events:[{id:H,payload:{productsList:a}}]});case 4:case"end":return e.stop()}}))}},{command:k,handler:function(e,t){var a=t.product;return{events:[{id:x,payload:{product:a}}]}}},{command:D,handler:function(e,t){var a=t.product;return{events:[{id:R,payload:{product:a}}]}}}],M=[{command:H,handler:function(e,t){var a=t.productsList;return{proposal:Object(p.a)({},e,{productsList:a})}}},{command:x,handler:function(e,t){var a=t.product;return{proposal:Object(p.a)({},e,{selectedProduct:a})}}}],F=a(346),I=a(168),$=a(350),N=a(44),q=a(355),B=a(72);function J(e){var t=e.product,a=e.size,c=e.onClick,l=Object(n.useState)(!1),o=Object(i.a)(l,2),u=o[0],m=o[1];return r.a.createElement(P.a,{size:a,fluid:!0,loading:u,color:"teal",onClick:function(){m(!0),setTimeout((function(){c(t),m(!1)}),500)}},r.a.createElement(P.a.Content,null,r.a.createElement(N.a,{name:"shop"})," Add to cart"))}function U(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],c=t[1],l=m(Q,(function(e){return e.productsList}),!0),o=Object(i.a)(l,1)[0];return r.a.createElement(w.a,{columns:3},o&&o.map((function(e){var t=e.id,n=e.img,l=e.title,i=e.price,o=e.rating,m=e.reviewsCount,s=e.newPrice,d=void 0===s?null:s,g=e.ccy;return r.a.createElement(w.a.Column,{key:t},r.a.createElement(F.a,null,d&&r.a.createElement(I.a,{fluid:!0,label:{as:"a",color:"orange",corner:"left",icon:"star"}}),r.a.createElement($.a.Dimmable,{as:I.a,onMouseOver:function(){c(t)},onMouseLeave:function(){c(null)},dimmed:a===t},r.a.createElement(I.a,{src:n,wrapped:!0}),r.a.createElement($.a,{active:a===t},r.a.createElement(P.a,{basic:!0,size:"small",color:"teal",onClick:function(){return function(e){u.selectAggregate(Q).sendCommand(k,{product:e})}(e)}},r.a.createElement(P.a.Content,null,r.a.createElement(N.a,{name:"magnify"})," Product details")))),r.a.createElement(F.a.Content,null,r.a.createElement(F.a.Header,{as:"a"},l),r.a.createElement(F.a.Meta,null,r.a.createElement(q.a,{size:"mini",disabled:!0,icon:"star",defaultRating:o,maxRating:5})," ",m," Reviews"),d&&r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a.Description,null,r.a.createElement("strike",null,g,i)," ",r.a.createElement(N.a,{name:"arrow right"})," ",r.a.createElement(B.a,{as:"span",color:"orange",tag:!0},g,d))),!d&&r.a.createElement(F.a.Description,null,g,i," ")),r.a.createElement(F.a.Content,{extra:!0},r.a.createElement(J,{size:"small",product:e,onClick:z}))))})))}var W=a(353),K=a(342);function Y(){var e=m(Q,(function(e){return e.selectedProduct})),t=Object(i.a)(e,1)[0];return r.a.createElement(r.a.Fragment,null," ",t&&r.a.createElement(W.a.Group,{horizontal:!0},r.a.createElement(W.a,null,r.a.createElement(I.a,{src:t.img,wrapped:!0}),r.a.createElement(W.a.Group,{horizontal:!0,compact:!0},[1,2,3].map((function(e){return r.a.createElement(W.a,{key:e,basic:!0},r.a.createElement(I.a,{src:t.img,size:"tiny"}))})))),r.a.createElement(W.a,null,r.a.createElement(b.a,{size:"huge"},t.title," ",t.newPrice&&r.a.createElement(B.a,{as:"span",color:"orange",tag:!0},"ON SALE")),r.a.createElement(o.a,null,r.a.createElement(q.a,{disabled:!0,icon:"star",defaultRating:t.rating,maxRating:5})," ",t.reviewsCount," Reviews"),r.a.createElement("br",null),r.a.createElement(o.a,null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),r.a.createElement("br",null),t.newPrice&&r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,{as:"span",color:"grey",basic:!0,size:"huge"},r.a.createElement("strike",null,t.ccy,t.price)),r.a.createElement(N.a,{name:"arrow right",size:"big"}),r.a.createElement(B.a,{as:"span",color:"orange",size:"huge"},t.ccy,t.newPrice)),!t.newPrice&&r.a.createElement(b.a,{size:"huge"},t.ccy,t.price),r.a.createElement(K.a,null),r.a.createElement(J,{size:"huge",product:t,onClick:z}))))}var Q="ProductsAggregate",V={name:Q,initialState:{productsList:[],selectedProduct:null},cmdHandlers:G,evtHandlers:M,bootstrap:function(){u.selectAggregate(Q).sendCommand(j)}},X="PRODUCT_ADDED_TO_CART",Z=[{command:X,handler:function(e,t){var a=t.product,n=e.items;if(n.has(a.id)){var r=n.get(a.id);n.set(a.id,Object(p.a)({},a,{count:r.count+1}))}else n.set(a.id,Object(p.a)({},a,{count:1}));return{proposal:Object(p.a)({},e,{items:n})}}}],ee=a(344),te=a(345);function ae(e){e.size;var t=m(ne,(function(e){return e||{}})),a=(Object(i.a)(t,1)[0]||{}).items,n=void 0===a?new Map:a,c=Array.from(n).map((function(e){return Object(p.a)({},e[1])}));return r.a.createElement(ee.a,{on:"click",position:"bottom right",trigger:r.a.createElement(P.a,{basic:!0,color:"teal",style:{marginLeft:"0.5em"}},r.a.createElement(N.a,{name:"shopping cart",color:"teal"}),c&&c.length>0&&r.a.createElement(B.a,{circular:!0,size:"tiny",color:"teal"},c.reduce((function(e,t){return+e+ +t.count}),0)))},r.a.createElement(ee.a.Content,null,(!c||0===c.length)&&r.a.createElement(W.a,{basic:!0,textAlign:"center"},r.a.createElement(N.a,{name:"frown outline",size:"big",color:"teal"}),r.a.createElement(b.a,{size:"tiny"},r.a.createElement(b.a.Subheader,null,"Your shopping cart is empty"))),c&&c.length>0&&r.a.createElement(te.a.Group,{divided:!0},c.map((function(e){var t=e.id,a=e.img,n=e.title,c=e.price,l=e.newPrice,i=e.ccy,o=e.count;return r.a.createElement(te.a,{key:t},r.a.createElement(te.a.Image,{size:"mini",src:a}),r.a.createElement(te.a.Content,null,r.a.createElement(te.a.Description,null,o&&o>1&&r.a.createElement(B.a,{circular:!0,size:"tiny",color:"black"},"x",o)," ",n),r.a.createElement(te.a.Meta,null,r.a.createElement("span",{className:"price"},i,(l||c)*o))))})),r.a.createElement(te.a,null,r.a.createElement(te.a.Header,{as:"h4"},"Total: ",c[0].ccy," ",c.reduce((function(e,t){return+e+ +(t.newPrice||t.price)*t.count}),0).toFixed(2))),r.a.createElement(te.a,null,r.a.createElement(te.a.Content,null,r.a.createElement(P.a,{fluid:!0,color:"teal"},"Checkout"))))))}var ne="ShoppingCartAggregate",re={name:ne,initialState:{items:new Map},cmdHandlers:[],evtHandlers:Z,bootstrap:function(){u.selectAggregate("ProductsAggregate").triggerAfter("ADD_TO_SHOPPING_CART_TRIGGERED",{targetAggregate:ne,triggeredEvent:X})}};var ce,le=function(){var e=m("NavigationAggregate",(function(e){return e.currentPage})),t=Object(i.a)(e,1)[0];return r.a.createElement("div",{style:{background:"#f8f9fa"}},r.a.createElement(o.a,null,r.a.createElement(h,{shoppingCartMenuItem:r.a.createElement(ae,null)}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(O,null),r.a.createElement("br",null),r.a.createElement("br",null),"home"===(!t||t)&&r.a.createElement(U,null),"product"===t&&r.a.createElement(Y,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));(ce=[V,S,re]).forEach((function(e){var t=e.name,a=e.initialState,n=void 0===a?{}:a,r=e.cmdHandlers,c=e.evtHandlers;!function(e,t,a){t&&t.forEach((function(t){var a=t.command,n=t.handler,r=t.onError,c=void 0===r?null:r;e.setCommandHandler(a,n,c)})),a&&a.forEach((function(t){var a=t.command,n=t.handler,r=t.onError,c=void 0===r?null:r;e.setEventHandler(a,n,c)}))}(u.createAggregate(t,n),r,c)})),ce.forEach((function(e){var t=e.bootstrap;return(void 0===t?function(){}:t)()})),l.a.render(r.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[177,1,2]]]);
//# sourceMappingURL=main.bce3248e.chunk.js.map